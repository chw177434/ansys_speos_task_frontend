# 任务状态展示 - 快速参考

## 🎨 状态视觉速查表

### 等待状态 (🟡 黄色系)

| 显示 | 说明 | 何时出现 |
|------|------|---------|
| ⏳ 等待中 | 任务已创建，等待Worker执行 | 刚提交任务时 |
| 📨 已接收 | Worker已接收任务 | Worker开始处理前 |

### 运行状态 (🔵 蓝色系)

| 显示 | 说明 | 何时出现 |
|------|------|---------|
| 📥 下载中 | 正在从对象存储下载文件 | 仅TOS上传模式 |
| 🚀 启动中 | 任务已启动 | 开始执行时 |
| ▶️ 运行中 | 任务正在执行 | 主要执行阶段 |
| ⚙️ 执行中 | 任务执行中（带进度） | 可追踪进度时 |

### 重试状态 (🟠 橙色系)

| 显示 | 说明 | 何时出现 |
|------|------|---------|
| 🔄 重试中 | 任务正在重试 | 遇到临时错误时 |

### 成功状态 (🟢 绿色系)

| 显示 | 说明 | 何时出现 |
|------|------|---------|
| ✅ 成功 | 任务执行成功 | 任务完成 |

### 失败状态 (🔴 红色系)

| 显示 | 说明 | 何时出现 |
|------|------|---------|
| ❌ 失败 | 任务执行失败 | 发生错误且无法恢复 |

### 取消状态 (⚫ 灰色系)

| 显示 | 说明 | 何时出现 |
|------|------|---------|
| 🚫 已撤销 | 任务已被撤销 | 系统撤销任务 |
| ⛔ 已取消 | 任务已取消 | 用户取消任务 |
| 🛑 已中止 | 任务已中止 | 强制停止任务 |

## 📊 典型流程示例

### 小文件上传（旧流程）

```
提交 → ⏳ 等待中 → 🚀 启动中 → ▶️ 运行中 → ✅ 成功
      (PENDING)    (STARTED)     (RUNNING)    (SUCCESS)
      ⏱️ 0-5秒      ⏱️ 1-2秒      ⏱️ 30-300秒   ⏱️ 终止
```

### 大文件上传（TOS流程）

```
提交 → ⏳ 等待中 → 📥 下载中 → 🚀 启动中 → ▶️ 运行中 → ✅ 成功
      (PENDING)    (DOWNLOADING)  (STARTED)     (RUNNING)    (SUCCESS)
      ⏱️ 0-5秒      ⏱️ 5-60秒      ⏱️ 1-2秒      ⏱️ 30-300秒   ⏱️ 终止
```

### 失败重试流程

```
提交 → ⏳ 等待中 → 🚀 启动中 → 🔄 重试中 → ▶️ 运行中 → ✅ 成功
      (PENDING)    (STARTED)     (RETRY)       (RUNNING)    (SUCCESS)
      ⏱️ 0-5秒      ⏱️ 1-2秒      ⏱️ 5-10秒     ⏱️ 30-300秒   ⏱️ 终止
```

### 取消流程

```
提交 → ⏳ 等待中 → 🚀 启动中 → [用户点击取消] → ⛔ 已取消
      (PENDING)    (STARTED)                      (CANCELLED)
      ⏱️ 0-5秒      ⏱️ 1-2秒                       ⏱️ 终止
```

## 🔍 状态筛选器

### 筛选选项（按关注度排序）

1. **全部状态** - 查看所有任务
2. **🔵 运行中** - 查看正在执行的任务
3. **🟡 等待中** - 查看等待执行的任务
4. **🟢 成功** - 查看成功完成的任务
5. **🔴 失败** - 查看失败的任务
6. **📥 下载中** - 查看正在下载的任务（TOS模式）
7. **🔵 启动中** - 查看正在启动的任务
8. **🔵 执行中** - 查看带进度的任务
9. **🟡 重试中** - 查看正在重试的任务
10. **⚫ 已取消** - 查看已取消的任务
11. **⚫ 已撤销** - 查看已撤销的任务

### 使用技巧

- **查看进行中的任务**：选择"运行中"或"启动中"
- **检查问题**：选择"失败"或"重试中"
- **清理已完成**：选择"成功"，批量删除
- **查看等待队列**：选择"等待中"

## ⏱️ 自动刷新规则

### 会自动刷新的状态（每5秒）

- ⏳ 等待中
- 📨 已接收
- 📥 下载中
- 🚀 启动中
- ▶️ 运行中
- ⚙️ 执行中
- 🔄 重试中

### 不会自动刷新的状态（终止状态）

- ✅ 成功
- ❌ 失败
- 🚫 已撤销
- ⛔ 已取消
- 🛑 已中止

**原因**：终止状态不会再改变，无需轮询，节省服务器资源

## 💡 使用建议

### 1. 关注正在运行的任务

**操作**：选择筛选器 "🔵 运行中"

**效果**：只显示正在执行的任务，方便监控进度

### 2. 查看下载进度（大文件）

**识别**：看到 "📥 下载中" 状态

**说明**：任务在从对象存储下载文件，这是正常的中间状态

**时长**：通常 5-60 秒，取决于文件大小和网络速度

### 3. 理解重试状态

**识别**：看到 "🔄 重试中" 状态（橙色）

**说明**：任务遇到临时问题，系统正在自动重试

**操作**：无需手动干预，等待系统自动恢复

**建议**：如果长时间停留在重试状态，可以查看任务详情或联系管理员

### 4. 区分取消类型

- **⛔ 已取消 (CANCELLED)**：用户主动取消
- **🚫 已撤销 (REVOKED)**：系统撤销（如资源不足）
- **🛑 已中止 (ABORTED)**：强制停止（如超时）

### 5. 鼠标悬停查看详情

**操作**：将鼠标移到状态标签上

**效果**：显示状态的详细说明

**示例**：
- 悬停在 "📥 下载中" → 显示"正在从对象存储下载文件"
- 悬停在时间戳 → 显示"状态更新时间: 2025/11/4 23:14:37"

## 🎯 常见问题

### Q1: 为什么任务一直停在"等待中"？

**可能原因**：
1. Worker 未启动或离线
2. 队列中有大量任务排队
3. 系统资源不足

**建议**：
1. 检查 Worker 状态
2. 查看队列长度
3. 联系管理员

### Q2: "下载中"状态正常吗？

**答**：完全正常！这是大文件上传（TOS模式）的必经阶段。

**说明**：你上传的文件先存储在对象存储中，Worker 需要下载到本地再执行。

**时长**：通常 5-60 秒，取决于文件大小。

### Q3: 看到"重试中"要担心吗？

**答**：不必担心，这是系统的自动恢复机制。

**说明**：任务遇到临时问题（如网络抖动、资源暂时不可用），系统会自动重试。

**关注点**：如果长时间（超过5分钟）停留在重试状态，可能需要人工介入。

### Q4: 如何快速找到失败的任务？

**操作**：点击状态筛选器，选择 "🔴 失败"

**效果**：只显示失败的任务，方便排查问题

### Q5: 成功的任务需要手动删除吗？

**建议**：
- **是**：如果不再需要结果文件，可以删除以节省存储空间
- **否**：如果需要保留结果，可以先下载再删除

**操作**：
1. 选择 "🟢 成功" 筛选器
2. 下载需要的结果文件
3. 点击"删除任务"按钮

## 📱 视觉示例

### 任务列表效果

```
┌──────────────────┬────────────┬──────────────┬─────────┐
│ 任务名称          │ Task ID    │ 状态          │ 时间    │
├──────────────────┼────────────┼──────────────┼─────────┤
│ simulation-001   │ abc-123    │ ⏳ 等待中    │ 刚刚    │
│ analysis-002     │ def-456    │ 📥 下载中    │ 5秒前   │
│ optimization-003 │ ghi-789    │ ▶️ 运行中    │ 30秒前  │
│ test-004         │ jkl-012    │ ✅ 成功      │ 2分钟前 │
│ demo-005         │ mno-345    │ ❌ 失败      │ 5分钟前 │
└──────────────────┴────────────┴──────────────┴─────────┘
```

### 状态徽章细节

```
┌───────────────────────┐
│  📥 下载中            │  ← 鼠标悬停
│  正在从对象存储下载... │  ← 显示提示
└───────────────────────┘
```

## 🔗 相关文档

- [任务状态展示优化方案](./任务状态展示优化方案.md) - 完整的技术实现文档
- [状态显示问题修复](./状态显示问题修复.md) - 之前修复的问题记录
- [重复任务问题修复报告](./重复任务问题修复报告.md) - 重复任务问题处理

---

**更新日期**：2025-11-04  
**版本**：v1.0  
**适用范围**：所有前端用户

