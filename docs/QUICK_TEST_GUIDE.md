# Include压缩包上传 - 快速测试指南

## 🚀 快速测试步骤

### 1. 启动开发服务器
```bash
npm run dev
```

### 2. 基础功能测试（5分钟）

#### ✅ 测试1：验证文件选择器限制
1. 打开上传表单
2. 点击"Include 文件（可选）"选择按钮
3. **预期结果**：只能选择文件，无法选择文件夹
4. **预期结果**：文件选择对话框已筛选为压缩包格式

#### ✅ 测试2：验证格式验证（错误情况）
1. 尝试选择一个 `.txt` 或 `.pdf` 文件
2. **预期结果**：弹出提示框，说明必须是压缩包格式
3. **预期结果**：文件选择被清空，不显示已选择文件

#### ✅ 测试3：验证格式验证（正确情况）
1. 选择一个 `.zip` 文件
2. **预期结果**：显示"已选择：xxx.zip"
3. **预期结果**：没有错误提示

#### ✅ 测试4：验证UI提示信息
1. 查看Include文件输入框下方
2. **预期结果**：显示琥珀色提示框
3. **预期结果**：提示信息包含：
   - "Include文件必须是压缩包格式（推荐.zip）"
   - 支持的格式列表
   - Windows和Mac的压缩方法

### 3. 上传功能测试（10分钟）

#### ✅ 测试5：只上传Master文件（不含Include）
1. 填写必要信息
2. 只选择Master文件
3. 不选择Include文件
4. 提交任务
5. **预期结果**：任务正常提交并创建

#### ✅ 测试6：上传Master + 小型Include压缩包（<10MB）
1. 填写必要信息
2. 选择Master文件
3. 选择一个小的.zip压缩包（<10MB）
4. 提交任务
5. **预期结果**：两个文件都正常上传
6. **预期结果**：使用旧流程上传（一次性上传）

#### ✅ 测试7：上传Master + 大型Include压缩包（>10MB）
1. 填写必要信息
2. 选择Master文件
3. 选择一个较大的.zip压缩包（>10MB）
4. 提交任务
5. **预期结果**：显示"使用断点续传模式"
6. **预期结果**：显示分片上传进度
7. **预期结果**：两个文件都正常上传

#### ✅ 测试8：测试其他压缩格式
测试以下格式（如果有）：
- `.rar` ✅
- `.7z` ✅
- `.tar.gz` ✅

### 4. 错误处理测试（5分钟）

#### ✅ 测试9：前端验证错误
1. 选择一个非压缩包文件（如.txt）
2. **预期结果**：立即弹出错误提示
3. **预期结果**：不发送任何网络请求
4. **预期结果**：文件选择被清空

#### ✅ 测试10：模拟后端400错误（可选）
如果后端有错误处理：
1. 故意上传不符合要求的文件（绕过前端验证）
2. **预期结果**：显示友好的错误信息
3. **预期结果**：错误信息包含压缩方法说明

## 📊 快速检查清单

### 界面检查
- [ ] "Include 文件（可选）" 标签正确显示
- [ ] 琥珀色提示框正确显示
- [ ] 提示信息清晰易懂
- [ ] 文件选择按钮正常工作

### 功能检查
- [ ] 无法选择文件夹
- [ ] 文件格式验证生效
- [ ] .zip文件可以正常选择
- [ ] 其他压缩格式可以正常选择
- [ ] 非压缩文件会被拒绝

### 上传检查
- [ ] 小文件上传正常
- [ ] 大文件使用断点续传
- [ ] 两个文件都正常上传到服务器
- [ ] 后端能正常处理压缩包

### 错误处理检查
- [ ] 前端验证错误提示友好
- [ ] 后端错误提示友好
- [ ] 错误信息格式正确

## 🐛 常见问题排查

### 问题1：无法选择压缩包文件
**解决方案**：
1. 检查浏览器控制台是否有错误
2. 确认文件扩展名正确（小写）
3. 尝试刷新页面

### 问题2：上传后后端报错400
**可能原因**：
1. 后端可能还在使用旧的API
2. 文件可能不是真正的压缩包（只是改了扩展名）
3. 压缩包可能损坏

**解决方案**：
1. 检查后端日志
2. 使用系统自带压缩工具重新压缩
3. 测试文件是否能正常解压

### 问题3：大文件上传失败
**解决方案**：
1. 检查网络连接
2. 确认后端支持分片上传
3. 查看浏览器控制台网络请求

## ✨ 快速成功案例

### 正确的使用流程
1. **准备include文件夹**
   ```
   include/
   ├── file1.txt
   ├── file2.dat
   └── subfolder/
       └── file3.txt
   ```

2. **压缩成.zip文件**
   - Windows: 右键 → "发送到" → "压缩(zipped)文件夹"
   - Mac: 右键 → "压缩"
   - 结果: `include.zip`

3. **上传到系统**
   - 选择Master文件：`master.xmp`
   - 选择Include文件：`include.zip`
   - 点击"提交任务"

4. **验证结果**
   - 任务创建成功
   - 两个文件都上传完成
   - 后端自动解压include.zip
   - Worker执行时include文件与master文件在同一目录

## 📞 需要帮助？

如果遇到问题：
1. 查看浏览器控制台（F12）
2. 检查网络请求（Network标签）
3. 查看后端日志
4. 参考 `docs/FRONTEND_INCLUDE_ARCHIVE_GUIDE.md`

---

**测试时间建议**: 总计20分钟  
**必做测试**: 测试1-6  
**可选测试**: 测试7-10

